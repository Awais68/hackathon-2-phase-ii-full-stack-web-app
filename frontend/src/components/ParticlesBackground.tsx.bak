'use client'

import { useEffect, useState } from 'react'

interface Particle {
  x: number
  y: number
  size: number
  speedX: number
  speedY: number
  opacity: number
}

export function ParticlesBackground() {
  const [particles, setParticles] = useState<Particle[]>([])
  const [mounted, setMounted] = useState(false)

  useEffect(() => {
    setMounted(true)

    // Initialize particles
    const newParticles: Particle[] = []
    for (let i = 0; i < 50; i++) {
      newParticles.push({
        x: Math.random() * window.innerWidth,
        y: Math.random() * window.innerHeight,
        size: Math.random() * 2 + 1,
        speedX: (Math.random() - 0.5) * 0.5,
        speedY: (Math.random() - 0.5) * 0.5,
        opacity: Math.random() * 0.5 + 0.2,
      })
    }
    setParticles(newParticles)

    // Animation loop
    let animationId: number
    const animate = () => {
      setParticles(prevParticles =>
        prevParticles.map(p => {
          let newX = p.x + p.speedX
          let newY = p.y + p.speedY

          if (newX < 0) newX = window.innerWidth
          if (newX > window.innerWidth) newX = 0
          if (newY < 0) newY = window.innerHeight
          if (newY > window.innerHeight) newY = 0

          return { ...p, x: newX, y: newY }
        })
      )
      animationId = requestAnimationFrame(animate)
    }

    animate()

    return () => {
      cancelAnimationFrame(animationId)
    }
  }, [])

  if (!mounted) return null

  return (
    <div className="particles-container">
      {particles.map((particle, i) => (
        <div
          key={i}
          className="particle"
          style={{
            left: particle.x,
            top: particle.y,
            width: particle.size,
            height: particle.size,
            opacity: particle.opacity,
          }}
        />
      ))}
      <style jsx>{`
        .particle {
          position: absolute;
          background: #00ffff;
          border-radius: 50%;
          pointer-events: none;
          box-shadow: 0 0 6px #00ffff;
        }
      `}</style>
    </div>
  )
}
